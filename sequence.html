<html>
    <head>
        <title>Shepard scale</title>
        <style>
            .note-button {
                width: 40px;
                height: 30px;
            }
            .note-label {
                height: 30px;
                margin-right: 10px;
            }
            .note-span {
            }
            .row-div {
                white-space: nowrap;
            }
        </style>
        <script src="main.js"></script>
        <script type="text/javascript">
            function getNoteCount() {
                var default_result = 12;

                // Get URL parameter.
                var url = new URL(window.location.href);
                var valueString = url.searchParams.get("notes");
                if (valueString === null) {
                    return default_result;
                }

                // Parse URL parameter.
                var valueInt = Number.parseInt(valueString);
                if (Number.isNaN(valueInt) || valueInt < 1 || valueInt > 12 || (12 % valueInt != 0)) {
                    return default_result;
                }
                return valueInt;
            }
            function createNoteButton(index, note) {
                var noteSpan = document.createElement("span");
                noteSpan.setAttribute('class', 'note-span');
                noteSpan.innerHTML =
                    "<button class='note-button' type='button' onmousedown='play(" + note + ");' onmouseup='stop();' onmouseleave='stop();'>" + (index + 1) + "</button>" +
                    "<input class='note-label' type='text'></input>";
                return noteSpan;
            }

            function initialize() {
                var noteCount = getNoteCount();
                document.getElementById("header").innerHTML="Using " + getNoteCount() + " notes";

                var sequence = document.getElementById("sequence");
                for (var row = 0; row < 25; ++row) {
                    var rowDiv = document.createElement("div");
                    rowDiv.setAttribute('class', 'row-div');
                    for (var col = 0; col < 4; ++col) {
                        // Pick random notes spaced equally. Use C (value "3") as a starting point.
                        var note = Math.floor(Math.random() * noteCount) * (12 / noteCount) + 3;
                        var index = 25 * col + row;
                        var button = createNoteButton(index, note);
                        rowDiv.appendChild(button);
                    }
                    sequence.appendChild(rowDiv);
                }
            }
        </script>
    </head>
    <body onload="initialize();">
        <div id = "header"></div>
        <div id = "sequence"></div>
    </body>
</html>
